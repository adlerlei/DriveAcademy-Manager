<!doctype html>
<html lang="zh-TW">
    <head>
        <meta charset="UTF-8" />
        <title>筆試清冊列印</title>
        <link rel="stylesheet" href="bulma/css/bulma.min.css" />
    </head>
    <body>
        <div class="container is-fluid">
            <!-- 標題部分保持不變 -->
            <div class="columns is-flex is-align-items-flex-end mb-0">
                <div class="is-2 column has-text-left is-size-6 has-text-weight-bold">交通部公路 局</div>
                <div class="is-6 column has-text-left is-size-6 has-text-weight-bold">
                    監理所(站)汽車駕駛人考驗記錄清冊
                </div>
                <div class="is-2 column has-text-right is-size-7">班名：佑名駕訓班</div>
                <div class="is-2 column has-text-right is-size-7">考驗別：{{ exam_type }}</div>
            </div>
            <div class="columns is-align-items-flex-end">
                <div class="column has-text-left is-size-7">期別：{{ period }}</div>
                <div class="column has-text-right is-size-7">筆試日期：{{ exam_date }}</div>
            </div>
        </div>
        <div class="column">
            {% if students %}
            {% set students_per_page = 90 %}
            {% set pages = (students|length + students_per_page - 1) // students_per_page %}
            
            {% for page in range(pages) %}
            <table class="table is-bordered is-striped is-fullwidth is-size-7">
                <thead>
                    <tr>
                        {% for i in range(2) %}
                            <th>序號</th>
                            <th>姓名</th>
                            <th>出生日期</th>
                            <th>筆試</th>
                            <th>路試</th>
                            <th>身份證字號</th>
                            <th>備註</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% macro render_student(student) %}
                        <td>{{ student.driving_test_number }}</td>
                        <td>{{ student.student_name }}</td>
                        <td>{{ student.birth_date }}</td>
                        <td></td>
                        <td></td>
                        <td>{{ student.national_id_no }}</td>
                        <td>{{ student.register_number }}</td>
                    {% endmacro %}

                    {% set start_index = page * students_per_page %}
                    {% set end_index = start_index + students_per_page %}
                    {% set page_students = students[start_index:end_index] %}
                    {% set left_limit = 45 %}
                    {% set rows = [page_students|length, 45]|min %}
                    
                    {% for i in range(rows) %}
                        <tr>
                            {# 左側表格 #}
                            {{ render_student(page_students[i]) }}

                            {# 右側表格 #}
                            {% set right_index = i + left_limit %}
                            {% if right_index < page_students|length %}
                                {{ render_student(page_students[right_index]) }}
                            {% else %}
                                {% for _ in range(7) %}<td></td>{% endfor %}
                            {% endif %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
            
            {% if not loop.last %}
            <div style="page-break-after: always;"></div>
            {% endif %}
            
            {% endfor %}
            {% else %}
            <p>沒有可顯示的數據。</p>
            {% endif %}
        </div>
    </body>
</html>
